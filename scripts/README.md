# ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©ë²•

í´ë¦­ë§ˆìŠ¤í„° í¬ë¡¤ëŸ¬ í”„ë¡œì íŠ¸ì˜ ë…ë¦½ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ëª¨ìŒì…ë‹ˆë‹¤.

## ğŸ“‹ ìŠ¤í¬ë¦½íŠ¸ ëª©ë¡

### 1. `crawl_news.py` - ë„¤ì´ë²„ ë‰´ìŠ¤ í¬ë¡¤ë§
ë„¤ì´ë²„ ë‰´ìŠ¤ë¥¼ í‚¤ì›Œë“œë³„ë¡œ í¬ë¡¤ë§í•˜ì—¬ Supabase ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤.

```bash
# ê¸°ë³¸ ì‹¤í–‰ (í•„ìˆ˜: --date íŒŒë¼ë¯¸í„°)
python scripts/crawl_news.py --date 2024-01-15

# í‚¤ì›Œë“œ ì§€ì •
python scripts/crawl_news.py --date 2024-01-15 --keywords "AI" "ë¨¸ì‹ ëŸ¬ë‹" "ë”¥ëŸ¬ë‹"

# ê¸°ì‚¬ ìˆ˜ ì œí•œ
python scripts/crawl_news.py --date 2024-01-15 --max-per-keyword 50

# í…ŒìŠ¤íŠ¸ ëª¨ë“œ (ì €ì¥í•˜ì§€ ì•ŠìŒ)
python scripts/crawl_news.py --date 2024-01-15 --dry-run
```

### 2. `sync_journalist_stats.py` - ê¸°ì í†µê³„ ë™ê¸°í™”
ê¸°ìë³„ í†µê³„ë¥¼ ë™ê¸°í™”í•˜ê³  ë¶ˆì¼ì¹˜ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.

```bash
# ê¸°ë³¸ ì‹¤í–‰ (í†µê³„ ë¶ˆì¼ì¹˜ ìˆ˜ì •)
python scripts/sync_journalist_stats.py

# ì „ì²´ ê¸°ì í†µê³„ ê°•ì œ ì—…ë°ì´íŠ¸
python scripts/sync_journalist_stats.py --full-update

# í†µê³„ ë¶ˆì¼ì¹˜ ìˆ˜ì • ë¹„í™œì„±í™”
python scripts/sync_journalist_stats.py --no-fix-inconsistencies

# ì¡°ìš©í•œ ëª¨ë“œ (ìš”ì•½ ì¶œë ¥ ìƒëµ)
python scripts/sync_journalist_stats.py --quiet

# ë””ë²„ê·¸ ëª¨ë“œ
python scripts/sync_journalist_stats.py --log-level DEBUG
```

## ğŸš€ ê¸°ì í†µê³„ ë™ê¸°í™” ìŠ¤í¬ë¦½íŠ¸ ìƒì„¸

### ê¸°ëŠ¥
- **í†µê³„ ë¶ˆì¼ì¹˜ ê°ì§€ ë° ìˆ˜ì •**: ì‹¤ì œ ê¸°ì‚¬ ìˆ˜ì™€ ì €ì¥ëœ í†µê³„ ê°„ ì°¨ì´ ìë™ ìˆ˜ì •
- **ì „ì²´ í†µê³„ ì¬ê³„ì‚°**: ëª¨ë“  ê¸°ìì˜ `article_count`, `avg_clickbait_score`, `max_score` ì—…ë°ì´íŠ¸
- **ìƒì„¸ ë¡œê¹…**: ëª¨ë“  ì‘ì—… ê³¼ì •ì„ ìƒì„¸íˆ ê¸°ë¡
- **ì—ëŸ¬ í•¸ë“¤ë§**: ê°œë³„ ê¸°ì ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ ì‹œì—ë„ ì „ì²´ ì‘ì—… ê³„ì† ì§„í–‰

### ì‹¤í–‰ ì¡°ê±´
1. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**:
   ```bash
   export SUPABASE_URL="your-supabase-url"
   export SUPABASE_SERVICE_ROLE_KEY="your-service-role-key"
   export SUPABASE_ANON_KEY="your-anon-key"
   ```

2. **Python ì˜ì¡´ì„±**:
   ```bash
   pip install -r requirements.txt
   ```

### ì˜µì…˜ ì„¤ëª…

| ì˜µì…˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|------|------|--------|
| `--log-level` | ë¡œê·¸ ë ˆë²¨ (DEBUG, INFO, WARNING, ERROR) | INFO |
| `--fix-inconsistencies` | í†µê³„ ë¶ˆì¼ì¹˜ ìë™ ìˆ˜ì • | True |
| `--no-fix-inconsistencies` | í†µê³„ ë¶ˆì¼ì¹˜ ìˆ˜ì • ë¹„í™œì„±í™” | False |
| `--full-update` | ëª¨ë“  ê¸°ì í†µê³„ ê°•ì œ ì—…ë°ì´íŠ¸ | False |
| `--quiet` | ìš”ì•½ ì¶œë ¥ ìƒëµ | False |

### ì¶œë ¥ ì˜ˆì‹œ

```
===============================================================
ğŸ“Š ê¸°ì í†µê³„ ë™ê¸°í™” ê²°ê³¼ ìš”ì•½
===============================================================
ğŸ• ì‹¤í–‰ ì‹œê°„: 12.34ì´ˆ
âœ… ì„±ê³µ ì—¬ë¶€: ì„±ê³µ

ğŸ“‹ ì‹¤í–‰ëœ ì‘ì—…: 2ê°œ
  - í†µê³„ ë¶ˆì¼ì¹˜ ìˆ˜ì •: 3/5ê±´
  - ì „ì²´ í†µê³„ ì—…ë°ì´íŠ¸: 25/25ëª…

ğŸ“ˆ í†µê³„ ë³€í™”:
  - ì´ ê¸°ì ìˆ˜: 25
  - í™œì„± ê¸°ì ìˆ˜: 20 â†’ 22 (+2)
  - ì ìˆ˜ ìˆëŠ” ê¸°ì ìˆ˜: 15 â†’ 18 (+3)
  - ì´ ê¸°ì‚¬ ìˆ˜: 67
  - ë¶„ì„ ì™„ë£Œ ê¸°ì‚¬ ìˆ˜: 18
  - ëŒ€ê¸° ì¤‘ ê¸°ì‚¬ ìˆ˜: 49
===============================================================
```

## ğŸ¤– GitHub Actions ìë™í™”

### ìë™ ì‹¤í–‰ ìŠ¤ì¼€ì¤„
- **ë§¤ì¼ 3íšŒ**: ì˜¤ì „ 9ì‹œ, ì˜¤í›„ 3ì‹œ, ì˜¤í›„ 9ì‹œ (KST)
- **ì£¼ê°„ ì „ì²´ ì—…ë°ì´íŠ¸**: ë§¤ì£¼ ì¼ìš”ì¼ ì˜¤ì „ 2ì‹œ (KST)

### ìˆ˜ë™ ì‹¤í–‰
GitHub Actions íƒ­ì—ì„œ `Sync Journalist Statistics` workflowë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜µì…˜:
- **ëª¨ë“  ê¸°ì í†µê³„ ê°•ì œ ì—…ë°ì´íŠ¸**: ì „ì²´ ê¸°ì í†µê³„ ì¬ê³„ì‚°
- **ë¡œê·¸ ë ˆë²¨**: DEBUG, INFO, WARNING, ERROR ì¤‘ ì„ íƒ
- **í†µê³„ ë¶ˆì¼ì¹˜ ìˆ˜ì •**: ë¶ˆì¼ì¹˜ ê°ì§€ ë° ìˆ˜ì • í™œì„±í™”/ë¹„í™œì„±í™”

### ì•Œë¦¼ ê¸°ëŠ¥
- **ì‹¤íŒ¨ ì‹œ**: Slack `#alerts` ì±„ë„ë¡œ ì‹¤íŒ¨ ì•Œë¦¼
- **ì£¼ê°„ ì—…ë°ì´íŠ¸ ì„±ê³µ ì‹œ**: Slack `#updates` ì±„ë„ë¡œ ì„±ê³µ ì•Œë¦¼
- **ë¡œê·¸ ì•„í‹°íŒ©íŠ¸**: ì‹¤íŒ¨ ì‹œ ë¡œê·¸ íŒŒì¼ ìë™ ì—…ë¡œë“œ

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1. í™˜ê²½ ë³€ìˆ˜ ì˜¤ë¥˜
```
ERROR: í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤: SUPABASE_URL
```
**í•´ê²°**: `.env` íŒŒì¼ ë˜ëŠ” ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì— Supabase ì„¤ì • ì¶”ê°€

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨
```
ERROR: ê¸°ì í†µê³„ ì¼ê´„ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜: ...
```
**í•´ê²°**: 
- Supabase URLê³¼ í‚¤ í™•ì¸
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
- Supabase ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸

### 3. ê¶Œí•œ ì˜¤ë¥˜
```
ERROR: Permission denied
```
**í•´ê²°**: `SERVICE_ROLE_KEY` ì‚¬ìš© (ANON_KEYê°€ ì•„ë‹Œ)

### 4. ë©”ëª¨ë¦¬ ë¶€ì¡± (ëŒ€ëŸ‰ ì—…ë°ì´íŠ¸ ì‹œ)
```
ERROR: Memory limit exceeded
```
**í•´ê²°**: ë°°ì¹˜ í¬ê¸° ì¡°ì • ë˜ëŠ” ì„œë²„ ë©”ëª¨ë¦¬ ì¦ì„¤

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### ë¡œê·¸ íŒŒì¼ ìœ„ì¹˜
```
logs/sync_journalist_stats_YYYYMMDD.log
```

### ì£¼ìš” ë¡œê·¸ ë ˆë²¨
- **INFO**: ì¼ë°˜ì ì¸ ì§„í–‰ ìƒí™©
- **WARNING**: ì£¼ì˜ í•„ìš”í•œ ìƒí™© (ì¼ë¶€ ì‹¤íŒ¨ ë“±)
- **ERROR**: ì‹¬ê°í•œ ì˜¤ë¥˜
- **DEBUG**: ìƒì„¸í•œ ë””ë²„ê¹… ì •ë³´

### í†µê³„ í™•ì¸ ì¿¼ë¦¬
```sql
-- ê¸°ìë³„ í†µê³„ ìš”ì•½
SELECT 
  name, 
  publisher, 
  article_count, 
  avg_clickbait_score, 
  max_score,
  updated_at
FROM journalists 
WHERE article_count > 0
ORDER BY avg_clickbait_score DESC
LIMIT 10;

-- í†µê³„ ë¶ˆì¼ì¹˜ í™•ì¸
SELECT 
  j.name,
  j.article_count as stored_count,
  COUNT(a.id) as actual_count,
  j.avg_clickbait_score as stored_avg,
  AVG(a.clickbait_score) as actual_avg
FROM journalists j
LEFT JOIN articles a ON j.id = a.journalist_id
GROUP BY j.id, j.name, j.article_count, j.avg_clickbait_score
HAVING j.article_count != COUNT(a.id);
```

## ğŸ¯ ì„±ëŠ¥ ìµœì í™”

### ê¶Œì¥ì‚¬í•­
1. **ì •ê¸°ì ì¸ í†µê³„ ë™ê¸°í™”**: ë§¤ì¼ 3íšŒ ìë™ ì‹¤í–‰ìœ¼ë¡œ ë°ì´í„° ì¼ê´€ì„± ìœ ì§€
2. **ë°°ì¹˜ ì²˜ë¦¬**: ëŒ€ëŸ‰ ì—…ë°ì´íŠ¸ ì‹œ ë°°ì¹˜ ë‹¨ìœ„ë¡œ ì²˜ë¦¬
3. **ì¸ë±ìŠ¤ í™œìš©**: `journalist_id`, `clickbait_score` ì¸ë±ìŠ¤ í™œìš©
4. **ë¡œê·¸ ê´€ë¦¬**: ì£¼ê¸°ì ì¸ ë¡œê·¸ íŒŒì¼ ì •ë¦¬

### ì‹¤í–‰ ì‹œê°„ ì˜ˆìƒ
- **ë¶ˆì¼ì¹˜ ìˆ˜ì •**: 1-5ì´ˆ (ë¶ˆì¼ì¹˜ ê±´ìˆ˜ì— ë”°ë¼)
- **ì „ì²´ ì—…ë°ì´íŠ¸**: ê¸°ì ìˆ˜ Ã— 0.5ì´ˆ (25ëª… ê¸°ì¤€ ì•½ 12ì´ˆ)
- **ëŒ€ìš©ëŸ‰ ë°ì´í„°**: ê¸°ì 1000ëª… ê¸°ì¤€ ì•½ 8-10ë¶„ 